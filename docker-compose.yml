version: "3.5"
services:
  geth-base:
    image: docker.gbre.org/geth-base
    build: ./geth-base

  clef:
    image: docker.gbre.org/clef
    build: ./clef
    user: 1000:1000
    volumes:
      - /mnt/Scorpion/abi-cluster/test/clef:/home/ethereum/.clef
      - /mnt/Scorpion/abi-cluster/test/geth:/home/ethereum/.ethereum
      - /mnt/Raiden/abi-cluster/test/geth:/home/ethereum/.ethereum/keystore
    # chain 5 = goerli
    command: --chainid 5
    restart: unless-stopped

  geth:
    image: docker.gbre.org/geth
    build: ./geth
    user: 1000:1000
    ports:
      - 30303:30303
      - 8545:8545
    volumes:
      - /mnt/Scorpion/abi-cluster/test/clef:/home/ethereum/.clef
      - /mnt/Scorpion/abi-cluster/test/geth:/home/ethereum/.ethereum
      - /mnt/Raiden/abi-cluster/test/geth:/home/ethereum/.ethereum/keystore
    command: --goerli --http --signer=.clef/clef.ipc
    restart: unless-stopped
